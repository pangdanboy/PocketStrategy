{"ast":null,"code":"import IScroll from 'iscroll-custom/build/iscroll-probe';\nimport Login from './components/Login';\nimport Register from './components/Register';\nimport EditEmail from './components/EditEmail';\nimport Footer from './components/Footer';\nimport router from './router/index';\nexport default {\n  name: 'App',\n  data: function () {\n    return {\n      // 页面滚动对象(iscroll)\n      scroll: null,\n      // 导航栏动态类名\n      headerClass: 'start',\n      // 登录框是否显示\n      loginShow: false,\n      // 注册框是否显示\n      RegisterShow: false,\n      // 邮箱修改框是否显示\n      EditEmailShow: false\n    };\n  },\n  computed: {},\n  components: {\n    Login,\n    Register,\n    EditEmail,\n    Footer\n  },\n\n  mounted() {\n    console.log(this.$route); // 如果当前用户已经登录，刷新页面时更新用户状态\n\n    if (localStorage.userToken) {\n      this.$store.commit('changeCurrentUser', true); // 重置弹出框状态\n\n      this.$refs.mask.style = 'display: none';\n      this.loginShow = false;\n      this.RegisterShow = false;\n      this.EditEmailShow = false; // 刷新页面时更新用户信息\n\n      this.$axios.get('users/current').then(res => {\n        console.log(res.data);\n\n        if (res.data.admin) {\n          // 修改当前用户权限\n          this.$store.commit('changeAdmin', true);\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n    } else {\n      this.$store.commit('changeCurrentUser', false);\n    } // 创建iscroll对象\n\n\n    this.scroll = new IScroll('.wrap', {\n      mouseWheel: true,\n      // 允许鼠标滚轮\n      scrollbars: true,\n      // 滚动条\n      interactiveScrollbars: true,\n      // 允许点击交互滚动条\n      probeType: 3,\n      // 像素级滚动监听\n      disablePointer: true // 禁用鼠标拖动\n\n    }); // 监听滚动，动态为导航栏添加类名\n\n    this.scroll.on('scroll', e => {\n      // 此处不用箭头函数可以用this.x和this.y访问实时位置，用了箭头函数需要从实例上访问\n      // this.scroll.x\n      // 实时改变网页滚动距离和方向\n      this.$store.commit('changeScrollTop', -Math.round(this.scroll.y));\n      this.$store.commit('changeScrollDirection', this.scroll.directionY);\n      console.log(this.$store.state.currentScrollTop);\n      console.log(-Math.round(this.scroll.y));\n\n      if (this.scroll.directionY === 1) {\n        this.hiddenHeader();\n      } else {\n        this.showHeader();\n      } // 解决isrcoll的scrollTo方法指定页面滚动时，数值不准的问题\n\n\n      if (-Math.round(this.scroll.y) === 0) {\n        this.startHeader();\n      }\n    });\n    console.log(this.$route);\n  },\n\n  provide() {\n    return {};\n  },\n\n  methods: {\n    showHeader() {\n      console.log('显示头部');\n      this.headerClass = 'show';\n    },\n\n    hiddenHeader() {\n      console.log('隐藏头部');\n      this.headerClass = 'hidden';\n    },\n\n    startHeader() {\n      console.log('头部初始状态');\n      this.headerClass = 'start';\n    },\n\n    pageDown() {\n      console.log('点击页面滚动');\n      this.scroll.scrollTo(0, -window.innerHeight, 1000);\n    },\n\n    pageTop() {\n      this.scroll.scrollTo(0, 0, 1000);\n    },\n\n    // 刷新iscroll\n    refreshScroll() {\n      if (this.scroll !== null) {\n        this.scroll.refresh();\n      }\n    },\n\n    showLogin() {\n      this.loginShow = true;\n      this.$refs.mask.style = 'display: block';\n    },\n\n    hiddenLogin() {\n      this.loginShow = false;\n      this.$refs.mask.style = 'display: none';\n    },\n\n    showRegister() {\n      this.RegisterShow = true;\n      this.$refs.mask.style = 'display: block';\n    },\n\n    hiddenRegister() {\n      this.RegisterShow = false;\n      this.$refs.mask.style = 'display: none';\n    },\n\n    showEditEmail() {\n      this.EditEmailShow = true;\n      this.$refs.mask.style = 'display: block';\n    },\n\n    hiddenEditEmail() {\n      this.EditEmailShow = false;\n      this.$refs.mask.style = 'display: none';\n    },\n\n    logout() {\n      this.$message({\n        message: '已退出登录',\n        type: 'warning'\n      }); // 清除token\n\n      localStorage.removeItem('userToken'); // 如果当前不在主页，点击退出登录后返回主页\n      // console.log(this.$route)\n\n      if (this.$route.fullPath !== '/home') {\n        router.push('/home');\n      } // 修改登录状态\n\n\n      this.$store.commit('changeCurrentUser', false);\n    }\n\n  },\n  watch: {}\n};","map":{"version":3,"mappings":"AA2FA;AACA;AACA;AACA;AACA;AACA;AACA;EACAA,WADA;EAEAC;IACA;MACA;MACAC,YAFA;MAGA;MACAC,oBAJA;MAKA;MACAC,gBANA;MAOA;MACAC,mBARA;MASA;MACAC;IAVA;EAYA,CAfA;EAgBAC,YAhBA;EAkBAC;IACAC,KADA;IAEAC,QAFA;IAGAC,SAHA;IAIAC;EAJA,CAlBA;;EAwBAC;IACAC,yBADA,CAEA;;IACA;MACA,8CADA,CAEA;;MACA;MACA;MACA;MACA,2BANA,CAOA;;MACA;QACAA;;QACA;UACA;UACA;QACA;MACA,CANA,EAMAC,KANA,CAMAC;QACAF;MACA,CARA;IASA,CAjBA,MAiBA;MACA;IACA,CAtBA,CAuBA;;;IACA;MACAG,gBADA;MACA;MACAC,gBAFA;MAEA;MACAC,2BAHA;MAGA;MACAC,YAJA;MAIA;MACAC,oBALA,CAKA;;IALA,GAxBA,CA+BA;;IACA;MACA;MACA;MACA;MACA;MACA;MACAP;MACAA;;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA,CAZA,CAaA;;;MACA;QACA;MACA;IACA,CAjBA;IAkBAA;EACA,CA3EA;;EA4EAQ;IACA;EAEA,CA/EA;;EAgFAC;IACAC;MACAV;MACA;IACA,CAJA;;IAKAW;MACAX;MACA;IACA,CARA;;IASAY;MACAZ;MACA;IACA,CAZA;;IAaAa;MACAb;MACA;IACA,CAhBA;;IAiBAc;MACA;IACA,CAnBA;;IAoBA;IACAC;MACA;QACA;MACA;IACA,CAzBA;;IA0BAC;MACA;MACA;IACA,CA7BA;;IA8BAC;MACA;MACA;IACA,CAjCA;;IAkCAC;MACA;MACA;IACA,CArCA;;IAsCAC;MACA;MACA;IACA,CAzCA;;IA0CAC;MACA;MACA;IACA,CA7CA;;IA8CAC;MACA;MACA;IACA,CAjDA;;IAkDAC;MACA;QACAC,gBADA;QAEAC;MAFA,GADA,CAKA;;MACAC,qCANA,CAOA;MACA;;MACA;QACAC;MACA,CAXA,CAYA;;;MACA;IACA;;EAhEA,CAhFA;EAkJAC;AAlJA","names":["name","data","scroll","headerClass","loginShow","RegisterShow","EditEmailShow","computed","components","Login","Register","EditEmail","Footer","mounted","console","catch","err","mouseWheel","scrollbars","interactiveScrollbars","probeType","disablePointer","provide","methods","showHeader","hiddenHeader","startHeader","pageDown","pageTop","refreshScroll","showLogin","hiddenLogin","showRegister","hiddenRegister","showEditEmail","hiddenEditEmail","logout","message","type","localStorage","router","watch"],"sourceRoot":"src","sources":["App.vue"],"sourcesContent":["<template>\n  <div id=\"app\">\n    <!--导航栏-->\n    <nav :class=\"headerClass\">\n      <div class=\"logo\">\n        <h1>@拉吉莫拉拉</h1>\n      </div>\n      <ul class=\"nav-list\">\n        <li>\n          <i class=\"iconfont icon-sousuo\"></i>搜索\n          <b></b>\n        </li>\n        <router-link to=\"/home\" tag=\"li\">\n          <i class=\"iconfont icon-shouye\"></i>首页\n          <b></b>\n        </router-link>\n        <li>\n          <i class=\"iconfont icon-jinglingqiu\"></i>图鉴\n          <b></b>\n          <div>\n            <router-link to=\"/all\" tag=\"span\"><i class=\"iconfont icon-xingzhuang\"></i>全部</router-link>\n            <router-link to=\"/category\" tag=\"span\"><i class=\"iconfont icon-fenlei\"></i>分类</router-link>\n            <router-link to=\"/tag\" tag=\"span\"><i class=\"iconfont icon-24gf-tags\"></i>标签</router-link>\n          </div>\n        </li>\n        <li>\n          <i class=\"iconfont icon-siyecao\"></i>娱乐\n          <b></b>\n          <div>\n            <router-link to=\"/album\" tag=\"span\"><i class=\"iconfont icon-tupianbizhi\"></i>壁纸</router-link>\n            <router-link to=\"/talk\" tag=\"span\"><i class=\"iconfont icon-liuyan\"></i>说说</router-link>\n          </div>\n        </li>\n        <router-link to=\"/about\" tag=\"li\">\n          <i class=\"iconfont icon-paper\"></i>关于\n          <b></b>\n        </router-link>\n        <router-link to=\"/message\" tag=\"li\">\n          <i class=\"iconfont icon-liuyan1\"></i>留言\n          <b></b>\n        </router-link>\n        <li @click=\"showLogin\" v-if=\"!this.$store.state.currentUser\">\n          <i class=\"iconfont icon-denglu-copy\"></i>登录\n          <b></b>\n        </li>\n        <!--根据当前用户是否登录决定是否创建用户默认头像-->\n        <li class=\"avatar\" v-if=\"this.$store.state.currentUser\">\n          <img src=\"./assets/images/userAvatar.jpg\">\n          <b></b>\n          <div class=\"user-info\">\n            <router-link to=\"/user\" tag=\"span\">个人中心</router-link>\n            <span @click=\"logout\">退出登录</span>\n            <router-link to=\"/EditStrategy\" tag=\"span\" v-if=\"this.$store.state.admin\">写攻略</router-link>\n          </div>\n        </li>\n      </ul>\n    </nav>\n    <!--主体内容部分-->\n    <div class=\"wrap\">\n      <div class=\"wrapContainer\">\n        <!--内容部分-->\n        <main>\n            <!--路由出口-->\n            <router-view @refreshScroll=\"refreshScroll\" @showEditEmail=\"showEditEmail\"></router-view>\n            <!--页面一键向下滚动按钮-->\n            <span class=\"pageDown\" @click=\"pageDown\" v-show=\"this.$route.fullPath === '/home'\">\n              <i class=\"iconfont icon-xiangxia2\"></i>\n            </span>\n        </main>\n        <!--底部信息-->\n        <Footer v-show=\"this.$route.fullPath === '/home'\"></Footer>\n      </div>\n    </div>\n    <!--回到顶部和切换页面主题工具-->\n    <div class=\"tools\" v-show=\"this.$route.fullPath === '/home' && headerClass !== 'start'\">\n      <div class=\"pageUp\" @click=\"pageTop\">UP</div>\n      <div class=\"changeTheme\">\n        <i class=\"iconfont icon-suntaiyang\"></i>\n<!--        <i class=\"iconfont icon-moon\"></i>-->\n      </div>\n    </div>\n    <!--登录框-->\n    <Login v-show=\"loginShow\" @hiddenLogin=\"hiddenLogin\" @showRegister=\"showRegister\"></Login>\n    <!--注册框-->\n    <Register v-show=\"RegisterShow\" @hiddenRegister=\"hiddenRegister\" @showLogin=\"showLogin\"></Register>\n    <!--修改绑定邮箱框-->\n    <EditEmail v-show=\"EditEmailShow\" @hiddenEditEmail=\"hiddenEditEmail\"></EditEmail>\n    <div class=\"mask\" ref=\"mask\"></div>\n  </div>\n</template>\n<script>\nimport IScroll from 'iscroll-custom/build/iscroll-probe'\nimport Login from './components/Login'\nimport Register from './components/Register'\nimport EditEmail from './components/EditEmail'\nimport Footer from './components/Footer'\nimport router from './router/index'\nexport default {\n  name: 'App',\n  data: function () {\n    return {\n      // 页面滚动对象(iscroll)\n      scroll: null,\n      // 导航栏动态类名\n      headerClass: 'start',\n      // 登录框是否显示\n      loginShow: false,\n      // 注册框是否显示\n      RegisterShow: false,\n      // 邮箱修改框是否显示\n      EditEmailShow: false\n    }\n  },\n  computed: {\n  },\n  components: {\n    Login,\n    Register,\n    EditEmail,\n    Footer\n  },\n  mounted () {\n    console.log(this.$route)\n    // 如果当前用户已经登录，刷新页面时更新用户状态\n    if (localStorage.userToken) {\n      this.$store.commit('changeCurrentUser', true)\n      // 重置弹出框状态\n      this.$refs.mask.style = 'display: none'\n      this.loginShow = false\n      this.RegisterShow = false\n      this.EditEmailShow = false\n      // 刷新页面时更新用户信息\n      this.$axios.get('users/current').then(res => {\n        console.log(res.data)\n        if (res.data.admin) {\n          // 修改当前用户权限\n          this.$store.commit('changeAdmin', true)\n        }\n      }).catch(err => {\n        console.log(err)\n      })\n    } else {\n      this.$store.commit('changeCurrentUser', false)\n    }\n    // 创建iscroll对象\n    this.scroll = new IScroll('.wrap', {\n      mouseWheel: true, // 允许鼠标滚轮\n      scrollbars: true, // 滚动条\n      interactiveScrollbars: true, // 允许点击交互滚动条\n      probeType: 3, // 像素级滚动监听\n      disablePointer: true // 禁用鼠标拖动\n    })\n    // 监听滚动，动态为导航栏添加类名\n    this.scroll.on('scroll', e => {\n      // 此处不用箭头函数可以用this.x和this.y访问实时位置，用了箭头函数需要从实例上访问\n      // this.scroll.x\n      // 实时改变网页滚动距离和方向\n      this.$store.commit('changeScrollTop', -Math.round(this.scroll.y))\n      this.$store.commit('changeScrollDirection', this.scroll.directionY)\n      console.log(this.$store.state.currentScrollTop)\n      console.log(-Math.round(this.scroll.y))\n      if (this.scroll.directionY === 1) {\n        this.hiddenHeader()\n      } else {\n        this.showHeader()\n      }\n      // 解决isrcoll的scrollTo方法指定页面滚动时，数值不准的问题\n      if (-Math.round(this.scroll.y) === 0) {\n        this.startHeader()\n      }\n    })\n    console.log(this.$route)\n  },\n  provide () {\n    return {\n    }\n  },\n  methods: {\n    showHeader () {\n      console.log('显示头部')\n      this.headerClass = 'show'\n    },\n    hiddenHeader () {\n      console.log('隐藏头部')\n      this.headerClass = 'hidden'\n    },\n    startHeader () {\n      console.log('头部初始状态')\n      this.headerClass = 'start'\n    },\n    pageDown () {\n      console.log('点击页面滚动')\n      this.scroll.scrollTo(0, -window.innerHeight, 1000)\n    },\n    pageTop () {\n      this.scroll.scrollTo(0, 0, 1000)\n    },\n    // 刷新iscroll\n    refreshScroll () {\n      if (this.scroll !== null) {\n        this.scroll.refresh()\n      }\n    },\n    showLogin () {\n      this.loginShow = true\n      this.$refs.mask.style = 'display: block'\n    },\n    hiddenLogin () {\n      this.loginShow = false\n      this.$refs.mask.style = 'display: none'\n    },\n    showRegister () {\n      this.RegisterShow = true\n      this.$refs.mask.style = 'display: block'\n    },\n    hiddenRegister () {\n      this.RegisterShow = false\n      this.$refs.mask.style = 'display: none'\n    },\n    showEditEmail () {\n      this.EditEmailShow = true\n      this.$refs.mask.style = 'display: block'\n    },\n    hiddenEditEmail () {\n      this.EditEmailShow = false\n      this.$refs.mask.style = 'display: none'\n    },\n    logout () {\n      this.$message({\n        message: '已退出登录',\n        type: 'warning'\n      })\n      // 清除token\n      localStorage.removeItem('userToken')\n      // 如果当前不在主页，点击退出登录后返回主页\n      // console.log(this.$route)\n      if (this.$route.fullPath !== '/home') {\n        router.push('/home')\n      }\n      // 修改登录状态\n      this.$store.commit('changeCurrentUser', false)\n    }\n  },\n  watch: {\n  }\n}\n</script>\n<style scoped lang=\"scss\">\n  #app{\n    nav{\n      font-size: 14px;\n      width: 100%;\n      height: 50px;\n      color: #ffffff;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 0 20px;\n      box-sizing: border-box;\n      transition: all 1s;\n      position: fixed;\n      top: 0;\n      z-index: 999;\n      &.show{\n        top: 0;\n        background-color: rgba(255, 255, 255, 0.5);\n        color: #000000;\n      }\n      &.hidden{\n        top: -50px;\n      }\n      &.start{\n        background-color: rgba(255, 255, 255, 0);\n        color: #ffffff;\n      }\n      .logo{\n        h1{\n          white-space: nowrap;\n        }\n      }\n      .nav-list{\n        display: flex;\n        justify-content: space-between;\n        li{\n          margin: 0 15px;\n          width: 75px;\n          height: 25px;\n          cursor: pointer;\n          position: relative;\n          text-align: center;\n          line-height: 25px;\n          i{\n            margin-right: 2px;\n          }\n          b{\n            display: inline-block;\n            height: 3px;\n            width: 0;\n            background-color: #fff;\n            position: absolute;\n            bottom: -2px;\n            left: 50%;\n            transform: translate(-50%);\n            transition: all 0.5s;\n          }\n          &:hover{\n            b{\n              width: 65%;\n            }\n            div{\n              display: flex;\n            }\n          }\n          div{\n            width: 100%;\n            display: none;\n            flex-direction: column;\n            position: absolute;\n            top: 28px;\n            left: 50%;\n            transform: translate(-50%);\n            background-color: #ffffff;\n            span{\n              width: 100%;\n              height: 30px;\n              text-align: center;\n              font-size: 12px;\n              line-height: 30px;\n              color: #000000;\n              i{\n                margin-right: 5px;\n              }\n              &:hover{\n                background-color: skyblue;\n              }\n            }\n          }\n        }\n        .avatar{\n          img{\n            width: 25px;\n            height: 25px;\n            border-radius: 50%;\n          }\n          &:hover{\n            .user-info{\n              display: flex;\n            }\n          }\n          .user-info{\n            width: 100%;\n            display: none;\n            flex-direction: column;\n            position: absolute;\n            top: 28px;\n            left: 50%;\n            transform: translate(-50%);\n            background-color: #ffffff;\n            span{\n              width: 100%;\n              height: 30px;\n              text-align: center;\n              font-size: 12px;\n              line-height: 30px;\n              color: #000000;\n            }\n          }\n        }\n      }\n    }\n    main{\n      .pageDown{\n        display: inline-block;\n        width: 40px;\n        height: 40px;\n        background-color: rgba(255, 255, 255, 0.2);\n        position: absolute;\n        top: 93vh;\n        cursor: pointer;\n        left: 50%;\n        transform: translate(-50%);\n        animation: bounce 1s infinite;\n        @keyframes bounce {\n          from{\n            top: 93vh;\n          }\n          to{\n            top: 94vh;\n          }\n        }\n        i{\n          font-size: 30px;\n          position: absolute;\n          color: #ffffff;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n        }\n      }\n    }\n    .tools{\n      width: 35px;\n      height: 80px;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: space-between;\n      position: fixed;\n      bottom: 15px;\n      right: 15px;\n      transition: all 1s;\n      .pageUp{\n        width: 100%;\n        height: 35px;\n        background-color: rgba(0, 0, 0, 0.7);\n        text-align: center;\n        line-height: 35px;\n        cursor: pointer;\n        color: #ffffff;\n      }\n      .changeTheme{\n        width: 100%;\n        height: 35px;\n        background-color: rgba(0, 0, 0, 0.7);\n        text-align: center;\n        line-height: 35px;\n        color: #ffffff;\n      }\n    }\n    .wrap{\n      position: relative;\n      height: 100vh;\n      overflow: hidden;\n    }\n    #login, #register, #edit_email{\n      position: fixed;\n      left: 50%;\n      top: 150px;\n      transform: translate(-50%);\n      z-index: 1000;\n    }\n    #edit_email{\n      top: 35%;\n    }\n    .mask{\n      width: 100vw;\n      height: 100vh;\n      background-color: rgba(0, 0, 0, 0.3);\n      position: absolute;\n      left: 0;\n      top: 0;\n      z-index: 999;\n      display: none;\n    }\n  }\n</style>\n"]},"metadata":{},"sourceType":"module"}