{"ast":null,"code":"export default {\n  // eslint-disable-next-line vue/multi-word-component-names\n  name: 'Login',\n  data: function () {\n    return {\n      // 邮箱\n      email: '',\n      // 密码\n      password: '',\n      // 邮箱格式错误\n      emailErrorShow: false,\n      // 密码格式错误\n      passwordErrorShow: false,\n      // 提示样式类名\n      emailClass: '',\n      passwordClass: ''\n    };\n  },\n  computed: {},\n  methods: {\n    hidden() {\n      // 点击取消按钮调用父组件传递方法，隐藏登录框\n      this.$emit('hiddenLogin');\n    },\n\n    checkEmail() {\n      console.log('email失去焦点');\n\n      if (this.email.length === 0) {\n        // 提示错误\n        this.emailErrorShow = true; // 边框提示错误\n\n        this.emailClass = 'error';\n      } else {\n        this.emailErrorShow = false;\n        this.emailClass = '';\n      }\n    },\n\n    checkPassword() {\n      console.log('password失去焦点');\n\n      if (this.password.length === 0) {\n        this.passwordErrorShow = true;\n        this.passwordClass = 'error';\n      } else {\n        this.passwordErrorShow = false;\n        this.passwordClass = '';\n      }\n    },\n\n    login() {\n      console.log('点击了登录');\n\n      if (!this.emailErrorShow && !this.passwordErrorShow) {\n        console.log('发送请求');\n        this.$axios.post('users/login', {\n          email: this.email,\n          password: this.password\n        }).then(res => {\n          console.log(res.data);\n\n          if (res.data.code === 404) {\n            this.$message({\n              message: '用户不存在!',\n              type: 'warning'\n            });\n          }\n\n          if (res.data.code === 400) {\n            this.$message.error('密码错误!');\n          }\n\n          if (res.data.code === 200) {\n            this.$message({\n              message: '登录成功',\n              type: 'success'\n            }); // 点击取消按钮调用父组件传递方法，隐藏登录框\n\n            this.$emit('hiddenLogin'); // 修改当前用户登录状态\n\n            this.$store.commit('changeCurrentUser', true);\n\n            if (res.data.admin) {\n              // 修改当前用户权限\n              this.$store.commit('changeAdmin', true);\n            } // 保存token到localstorage\n\n\n            const {\n              token\n            } = res.data;\n            localStorage.setItem('userToken', token); // 清空表单数据\n\n            this.$refs.form.reset();\n          }\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n    },\n\n    showRegister() {\n      // 同时隐藏登录框\n      this.hidden(); // 点击注册按钮调用父组件传递方法，显示注册框\n\n      this.$emit('showRegister');\n    }\n\n  },\n  watch: {}\n};","map":{"version":3,"mappings":"AA+BA;EACA;EACAA,aAFA;EAGAC;IACA;MACA;MACAC,SAFA;MAGA;MACAC,YAJA;MAKA;MACAC,qBANA;MAOA;MACAC,wBARA;MASA;MACAC,cAVA;MAWAC;IAXA;EAaA,CAjBA;EAkBAC,YAlBA;EAoBAC;IACAC;MACA;MACA;IACA,CAJA;;IAKAC;MACAC;;MACA;QACA;QACA,2BAFA,CAGA;;QACA;MACA,CALA,MAKA;QACA;QACA;MACA;IACA,CAhBA;;IAiBAC;MACAD;;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;QACA;MACA;IACA,CA1BA;;IA2BAE;MACAF;;MACA;QACAA;QACA;UACAV,iBADA;UAEAC;QAFA,GAGAY,IAHA,CAGAC;UACAJ;;UACA;YACA;cACAK,iBADA;cAEAC;YAFA;UAIA;;UACA;YACA;UACA;;UACA;YACA;cACAD,eADA;cAEAC;YAFA,GADA,CAKA;;YACA,0BANA,CAOA;;YACA;;YACA;cACA;cACA;YACA,CAZA,CAaA;;;YACA;cAAAC;YAAA;YACAC,yCAfA,CAgBA;;YACA;UACA;QACA,CAjCA,EAiCAC,KAjCA,CAiCAC;UACAV;QACA,CAnCA;MAoCA;IACA,CApEA;;IAqEAW;MACA;MACA,cAFA,CAGA;;MACA;IACA;;EA1EA,CApBA;EAgGAC;AAhGA","names":["name","data","email","password","emailErrorShow","passwordErrorShow","emailClass","passwordClass","computed","methods","hidden","checkEmail","console","checkPassword","login","then","res","message","type","token","localStorage","catch","err","showRegister","watch"],"sourceRoot":"src/components","sources":["Login.vue"],"sourcesContent":["<template>\r\n  <div id=\"login\">\r\n    <form ref=\"form\">\r\n      <div class=\"slogan\">\r\n        <p>欢迎来到口袋觉醒</p>\r\n      </div>\r\n      <div class=\"username\" :class=\"emailClass\">\r\n        <span>邮箱:</span>\r\n        <input type=\"email\" v-model=\"email\" @blur=\"checkEmail\">\r\n        <span class=\"format-error-tips\" v-show=\"emailErrorShow\">账号不能为空</span>\r\n      </div>\r\n      <div class=\"password\" :class=\"passwordClass\">\r\n        <span>密码:</span>\r\n        <input type=\"password\" v-model=\"password\" @blur=\"checkPassword\">\r\n        <span class=\"format-error-tips\" v-show=\"passwordErrorShow\">密码不能为空</span>\r\n      </div>\r\n      <div class=\"submit\">\r\n        <input type=\"submit\" @click.prevent=\"login\" value=\"登录\" ref=\"submit\">\r\n      </div>\r\n      <div class=\"cancel\" @click=\"hidden\">\r\n        <i class=\"iconfont icon-xianshi_quxiao\"></i>\r\n      </div>\r\n      <div class=\"jumpRegister\">\r\n        <span>没有账号?</span>\r\n        <span class=\"clickRegister\" @click=\"showRegister\">点击注册</span>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  // eslint-disable-next-line vue/multi-word-component-names\r\n  name: 'Login',\r\n  data: function () {\r\n    return {\r\n      // 邮箱\r\n      email: '',\r\n      // 密码\r\n      password: '',\r\n      // 邮箱格式错误\r\n      emailErrorShow: false,\r\n      // 密码格式错误\r\n      passwordErrorShow: false,\r\n      // 提示样式类名\r\n      emailClass: '',\r\n      passwordClass: ''\r\n    }\r\n  },\r\n  computed: {\r\n  },\r\n  methods: {\r\n    hidden () {\r\n      // 点击取消按钮调用父组件传递方法，隐藏登录框\r\n      this.$emit('hiddenLogin')\r\n    },\r\n    checkEmail () {\r\n      console.log('email失去焦点')\r\n      if (this.email.length === 0) {\r\n        // 提示错误\r\n        this.emailErrorShow = true\r\n        // 边框提示错误\r\n        this.emailClass = 'error'\r\n      } else {\r\n        this.emailErrorShow = false\r\n        this.emailClass = ''\r\n      }\r\n    },\r\n    checkPassword () {\r\n      console.log('password失去焦点')\r\n      if (this.password.length === 0) {\r\n        this.passwordErrorShow = true\r\n        this.passwordClass = 'error'\r\n      } else {\r\n        this.passwordErrorShow = false\r\n        this.passwordClass = ''\r\n      }\r\n    },\r\n    login () {\r\n      console.log('点击了登录')\r\n      if (!this.emailErrorShow && !this.passwordErrorShow) {\r\n        console.log('发送请求')\r\n        this.$axios.post('users/login', {\r\n          email: this.email,\r\n          password: this.password\r\n        }).then((res) => {\r\n          console.log(res.data)\r\n          if (res.data.code === 404) {\r\n            this.$message({\r\n              message: '用户不存在!',\r\n              type: 'warning'\r\n            })\r\n          }\r\n          if (res.data.code === 400) {\r\n            this.$message.error('密码错误!')\r\n          }\r\n          if (res.data.code === 200) {\r\n            this.$message({\r\n              message: '登录成功',\r\n              type: 'success'\r\n            })\r\n            // 点击取消按钮调用父组件传递方法，隐藏登录框\r\n            this.$emit('hiddenLogin')\r\n            // 修改当前用户登录状态\r\n            this.$store.commit('changeCurrentUser', true)\r\n            if (res.data.admin) {\r\n              // 修改当前用户权限\r\n              this.$store.commit('changeAdmin', true)\r\n            }\r\n            // 保存token到localstorage\r\n            const { token } = res.data\r\n            localStorage.setItem('userToken', token)\r\n            // 清空表单数据\r\n            this.$refs.form.reset()\r\n          }\r\n        }).catch((err) => {\r\n          console.log(err)\r\n        })\r\n      }\r\n    },\r\n    showRegister () {\r\n      // 同时隐藏登录框\r\n      this.hidden()\r\n      // 点击注册按钮调用父组件传递方法，显示注册框\r\n      this.$emit('showRegister')\r\n    }\r\n  },\r\n  watch: {\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n  #login{\r\n    width: 500px;\r\n    height: 400px;\r\n    background-color: rgba(255, 255, 255, 0.6);\r\n    form{\r\n      width: 100%;\r\n      height: 100%;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      justify-content: flex-start;\r\n      div{\r\n        width: 400px;\r\n        height: 70px;\r\n        margin-bottom: 20px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: flex-start;\r\n        position: relative;\r\n        &.error{\r\n          input{\r\n            border: 1px solid red !important;\r\n          }\r\n        }\r\n        span{\r\n          margin-right: 5px;\r\n          font-size: 20px;\r\n        }\r\n        .error-tips,.format-error-tips{\r\n          position: absolute;\r\n          bottom: -5px;\r\n          left: 50px;\r\n          font-size: 14px;\r\n          color: red;\r\n        }\r\n        .error-tips{\r\n          top: -5px;\r\n          left: 50px;\r\n        }\r\n        input[type=password],input[type=email]{\r\n          width: 300px;\r\n          height: 35px;\r\n          border: none;\r\n          outline: none;\r\n          padding: 5px;\r\n          box-sizing: border-box;\r\n          border-radius: 5px;\r\n        }\r\n        input[type=submit]{\r\n          width: 300px;\r\n          height: 35px;\r\n          border: none;\r\n          cursor: pointer;\r\n          border-radius: 5px;\r\n        }\r\n      }\r\n      .slogan{\r\n        justify-content: center;\r\n        font-size: 22px;\r\n        border-bottom: 1px dashed #000000;\r\n      }\r\n      .submit{\r\n        justify-content: center;\r\n      }\r\n      .cancel{\r\n        width: 20px;\r\n        height: 20px;\r\n        position: fixed;\r\n        top: 2px;\r\n        right: 2px;\r\n        margin: 0;\r\n        cursor: pointer;\r\n        i{\r\n          font-size: 20px;\r\n        }\r\n      }\r\n      .jumpRegister{\r\n        width: 150px;\r\n        height: 20px;\r\n        position: fixed;\r\n        bottom: 10px;\r\n        left: 30px;\r\n        span{\r\n          font-size: 14px;\r\n        }\r\n        .clickRegister{\r\n          cursor: pointer;\r\n          color: rgb(171, 84, 90);\r\n        }\r\n      }\r\n    }\r\n  }\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}